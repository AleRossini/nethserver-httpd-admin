SSLProxyEngine On

SetEnvIf User-Agent ".*MSIE.*" nokeepalive ssl-unclean-shutdown downgrade-1.0 force-response-1.0
{
    my $chain_file = $modSSL{CertificateChainFile} || "";
    if ($chain_file ne "")
    {
       $OUT .= "SSLCertificateChainFile $chain_file";
    }

    my $crt = $modSSL{'crt'} ||
	"/home/e-smith/ssl.crt/${SystemName}.${DomainName}.crt";

    my $key = $modSSL{'key'} ||
	"/home/e-smith/ssl.key/${SystemName}.${DomainName}.key";
	
    $OUT .= <<SSL_END;
SSLCertificateFile $crt
SSLCertificateKeyFile $key
SSL_END

$OUT .= "SSLCipherSuite $modSSL{CipherSuite}";
}

SSLPassPhraseDialog  builtin
SSLSessionCache         shmcb:/var/cache/mod_ssl/scache(512000)
SSLSessionCacheTimeout  300
SSLMutex  file:state/ssl_mutex
SSLRandomSeed startup file:/dev/urandom 512
SSLRandomSeed connect builtin
{
    # Specify which SSL Protocols to accept for this context
    $OUT .= "SSLProtocol all";
    $OUT .= " -SSLv2" unless (defined(${'httpd'}{'SSLv2'}) && ${'httpd'}{'SSLv2'} eq 'enabled');
}
